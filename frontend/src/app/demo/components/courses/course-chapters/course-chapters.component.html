<!-- Nom du cours -->
<div class="card p-6 shadow-lg rounded-lg bg-white mb-4">
  <h5 class="text-2xl font-extrabold text-indigo-600 flex items-center gap-2"> <span>ğŸ“˜</span> {{ course.titre }} </h5>
</div> <!-- Formulaire ajout chapitre -->
<div class="card p-6 mt-6 shadow-lg rounded-lg bg-white border border-gray-200">
  <h6 class="text-xl text-green-700 font-semibold mb-5 flex items-center gap-2"> <span>â•</span> Ajouter un chapitre
  </h6>
  <div class="grid formgrid p-fluid gap-6"> <!-- Titre -->
    <div class="field col-12 md:col-6"> <label for="titre"
        class="block mb-2 text-sm font-medium text-gray-700">Titre</label> <input id="titre" type="text" pInputText
        [(ngModel)]="newChapter.titre" placeholder="Titre du chapitre"
        class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" />
    </div> <!-- Description -->
    <div class="field col-12"> <label for="desc"
        class="block mb-2 text-sm font-medium text-gray-700">Description</label> <textarea id="desc" pInputTextarea
        rows="4" [(ngModel)]="newChapter.description" placeholder="Description du chapitre"
        class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 transition resize-none"></textarea>
    </div> <!-- Fichier -->
    <div class="field col-12"> <label for="file" class="block mb-2 text-sm font-medium text-gray-700">Fichier
        (PDF/Image)</label> <label for="file"
        class="block w-full p-3 bg-indigo-50 border-2 border-dashed border-indigo-300 rounded-md cursor-pointer hover:bg-indigo-100 transition text-center text-indigo-600">
        {{ selectedFileName || 'ğŸ“ Choisir un fichier' }} <input id="file" type="file" accept="application/pdf"
          class="hidden" (change)="onFileSelected($event)" /> </label> <!-- AperÃ§u image -->
      <div class="mt-4" *ngIf="previewUrl">
        <p class="text-sm text-gray-500 mb-1">AperÃ§u :</p> <img [src]="previewUrl" alt="AperÃ§u temporaire"
          class="chapter-image-preview" /> <button class="mt-2 text-red-600 text-sm hover:underline"
          (click)="removeSelectedFile()" type="button"> âŒ Supprimer </button>
      </div>
    </div>
  </div> <!-- Bouton ajout -->
  <div class="mt-5 flex justify-end items-center gap-2"> <button pButton label="Ajouter le chapitre" icon="pi pi-plus"
      class="p-button-success p-button-rounded px-6 py-3 shadow-md hover:shadow-lg transition" (click)="createChapter()"
      [disabled]="loading || !newChapter.titre.trim()"></button> <!-- Loader pendant crÃ©ation --> <span *ngIf="loading"
      class="loading-spinner"></span> </div>
</div>

<div *ngFor="let chapter of chapters" class="chapter-card-shared">
  <div class="chapter-header">
    <!-- Infos chapitre -->
    <div class="chapter-info">
      <h5 class="chapter-title">{{ chapter.titre }}</h5>
      <p class="chapter-desc">{{ chapter.description }}</p>

      <!-- Documents -->
      <div *ngIf="chapter.documents?.length > 0">
        <div *ngFor="let doc of chapter.documents" class="chapter-doc">
          <i class="pi pi-file-pdf pdf-icon"></i>
          <a [href]="doc.supabase_url" target="_blank">{{ doc.filename }}</a>
        </div>
      </div>
    </div>

    <!-- Boutons alignÃ©s Ã  droite -->
    <div class="chapter-actions">
      <button pButton type="button" label="RÃ©sumÃ©" [routerLink]="['/chapter-resume', chapter.id]"
              icon="pi pi-book" class="p-button-sm p-button-info"></button>

      <button pButton icon="pi pi-share-alt" label="Partager"
              class="p-button-sm p-button-help"
              (click)="openShareDialog('chapter', chapter.id)">
      </button>

      <button pButton type="button" label="Supprimer" icon="pi pi-trash"
              class="p-button-sm p-button-danger"
              (click)="confirmDeleteChapter(chapter.id)">
      </button>
    </div>
  </div>
</div>
